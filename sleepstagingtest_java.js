criterion="./data/criterion/P2/13620,./data/criterion/P2/13590,./data/criterion/P2/13650,5#./data/criterion/P1/23040,./data/criterion/P1/23010,./data/criterion/P1/23070,2#./data/criterion/P5/12330,./data/criterion/P5/12300,./data/criterion/P5/12360,2#./data/criterion/P7/16170,./data/criterion/P7/16140,./data/criterion/P7/16200,5#./data/criterion/P10/19410,./data/criterion/P10/19380,./data/criterion/P10/19440,5#./data/criterion/P5/27090,./data/criterion/P5/27060,./data/criterion/P5/27120,1#./data/criterion/P7/660,./data/criterion/P7/630,./data/criterion/P7/690,0#./data/criterion/P8/18540,./data/criterion/P8/18510,./data/criterion/P8/18570,1#./data/criterion/P8/10800,./data/criterion/P8/10770,./data/criterion/P8/10830,3#./data/criterion/P1/22140,./data/criterion/P1/22110,./data/criterion/P1/22170,2#./data/criterion/P3/6420,./data/criterion/P3/6390,./data/criterion/P3/6450,2#./data/criterion/P8/23430,./data/criterion/P8/23400,./data/criterion/P8/23460,2#./data/criterion/P10/6540,./data/criterion/P10/6510,./data/criterion/P10/6570,5#./data/criterion/P10/13170,./data/criterion/P10/13140,./data/criterion/P10/13200,5#./data/criterion/P5/13560,./data/criterion/P5/13530,./data/criterion/P5/13590,3#./data/criterion/P9/15870,./data/criterion/P9/15840,./data/criterion/P9/15900,0#./data/criterion/P5/19080,./data/criterion/P5/19050,./data/criterion/P5/19110,2#./data/criterion/P7/9060,./data/criterion/P7/9030,./data/criterion/P7/9090,3#./data/criterion/P9/17340,./data/criterion/P9/17310,./data/criterion/P9/17370,2#./data/criterion/P10/21270,./data/criterion/P10/21240,./data/criterion/P10/21300,5#";
block1="./data/outputs_part1/P7/14280,./data/outputs_part1/P7/14250,./data/outputs_part1/P7/14310,3#./data/outputs_part1/P3/9000,./data/outputs_part1/P3/8970,./data/outputs_part1/P3/9030,2#./data/outputs_part1/P9/6120,./data/outputs_part1/P9/6090,./data/outputs_part1/P9/6150,3#./data/outputs_part1/P7/990,./data/outputs_part1/P7/960,./data/outputs_part1/P7/1020,0#./data/outputs_part1/P10/11190,./data/outputs_part1/P10/11160,./data/outputs_part1/P10/11220,2#./data/outputs_part1/P7/14070,./data/outputs_part1/P7/14040,./data/outputs_part1/P7/14100,3#./data/outputs_part1/P3/1650,./data/outputs_part1/P3/1620,./data/outputs_part1/P3/1680,2#./data/outputs_part2/P8/3120,./data/outputs_part2/P8/3090,./data/outputs_part2/P8/3150,0#./data/outputs_part1/P2/21390,./data/outputs_part1/P2/21360,./data/outputs_part1/P2/21420,5#./data/outputs_part2/P10/14250,./data/outputs_part2/P10/14220,./data/outputs_part2/P10/14280,0#./data/outputs_part2/P4/6750,./data/outputs_part2/P4/6720,./data/outputs_part2/P4/6780,2#./data/outputs_part2/P1/10230,./data/outputs_part2/P1/10200,./data/outputs_part2/P1/10260,2#./data/outputs_part1/P2/21090,./data/outputs_part1/P2/21060,./data/outputs_part1/P2/21120,5#./data/outputs_part1/P1/11370,./data/outputs_part1/P1/11340,./data/outputs_part1/P1/11400,3#./data/outputs_part1/P5/22440,./data/outputs_part1/P5/22410,./data/outputs_part1/P5/22470,2#./data/outputs_part1/P5/25440,./data/outputs_part1/P5/25410,./data/outputs_part1/P5/25470,0#./data/outputs_part1/P8/19800,./data/outputs_part1/P8/19770,./data/outputs_part1/P8/19830,2#./data/outputs_part1/P6/17010,./data/outputs_part1/P6/16980,./data/outputs_part1/P6/17040,3#./data/outputs_part1/P5/10020,./data/outputs_part1/P5/9990,./data/outputs_part1/P5/10050,0#./data/outputs_part1/P1/6060,./data/outputs_part1/P1/6030,./data/outputs_part1/P1/6090,3#./data/outputs_part1/P9/1230,./data/outputs_part1/P9/1200,./data/outputs_part1/P9/1260,2#./data/outputs_part1/P6/22890,./data/outputs_part1/P6/22860,./data/outputs_part1/P6/22920,5#./data/outputs_part1/P8/27600,./data/outputs_part1/P8/27570,./data/outputs_part1/P8/27630,0#./data/outputs_part1/P7/14670,./data/outputs_part1/P7/14640,./data/outputs_part1/P7/14700,2#./data/outputs_part1/P5/20310,./data/outputs_part1/P5/20280,./data/outputs_part1/P5/20340,1#./data/outputs_part2/P1/16200,./data/outputs_part2/P1/16170,./data/outputs_part2/P1/16230,2#./data/outputs_part1/P8/27780,./data/outputs_part1/P8/27750,./data/outputs_part1/P8/27810,5#./data/outputs_part1/P4/11910,./data/outputs_part1/P4/11880,./data/outputs_part1/P4/11940,1#./data/outputs_part1/P7/23280,./data/outputs_part1/P7/23250,./data/outputs_part1/P7/23310,5#./data/outputs_part1/P9/23790,./data/outputs_part1/P9/23760,./data/outputs_part1/P9/23820,2"
block2="./data/outputs_part1/P10/330,./data/outputs_part1/P10/300,./data/outputs_part1/P10/360,0#./data/outputs_part2/P7/21330,./data/outputs_part2/P7/21300,./data/outputs_part2/P7/21360,2#./data/outputs_part2/P1/3540,./data/outputs_part2/P1/3510,./data/outputs_part2/P1/3570,0#./data/outputs_part1/P1/9720,./data/outputs_part1/P1/9690,./data/outputs_part1/P1/9750,1#./data/outputs_part2/P6/11340,./data/outputs_part2/P6/11310,./data/outputs_part2/P6/11370,0#./data/outputs_part1/P6/20190,./data/outputs_part1/P6/20160,./data/outputs_part1/P6/20220,2#./data/outputs_part1/P3/12090,./data/outputs_part1/P3/12060,./data/outputs_part1/P3/12120,5#./data/outputs_part1/P10/20460,./data/outputs_part1/P10/20430,./data/outputs_part1/P10/20490,5#./data/outputs_part1/P5/27150,./data/outputs_part1/P5/27120,./data/outputs_part1/P5/27180,0#./data/outputs_part1/P2/27450,./data/outputs_part1/P2/27420,./data/outputs_part1/P2/27480,5#./data/outputs_part2/P5/20880,./data/outputs_part2/P5/20850,./data/outputs_part2/P5/20910,0#./data/outputs_part2/P4/3750,./data/outputs_part2/P4/3720,./data/outputs_part2/P4/3780,3#./data/outputs_part1/P2/16560,./data/outputs_part1/P2/16530,./data/outputs_part1/P2/16590,2#./data/outputs_part2/P7/17640,./data/outputs_part2/P7/17610,./data/outputs_part2/P7/17670,5#./data/outputs_part1/P5/13080,./data/outputs_part1/P5/13050,./data/outputs_part1/P5/13110,3#./data/outputs_part2/P7/9570,./data/outputs_part2/P7/9540,./data/outputs_part2/P7/9600,3#./data/outputs_part1/P3/20970,./data/outputs_part1/P3/20940,./data/outputs_part1/P3/21000,2#./data/outputs_part1/P9/360,./data/outputs_part1/P9/330,./data/outputs_part1/P9/390,0#./data/outputs_part1/P1/4440,./data/outputs_part1/P1/4410,./data/outputs_part1/P1/4470,2#./data/outputs_part1/P5/14430,./data/outputs_part1/P5/14400,./data/outputs_part1/P5/14460,3#./data/outputs_part1/P10/600,./data/outputs_part1/P10/570,./data/outputs_part1/P10/630,0#./data/outputs_part1/P1/13230,./data/outputs_part1/P1/13200,./data/outputs_part1/P1/13260,2#./data/outputs_part2/P3/10470,./data/outputs_part2/P3/10440,./data/outputs_part2/P3/10500,3#./data/outputs_part1/P4/12480,./data/outputs_part1/P4/12450,./data/outputs_part1/P4/12510,2#./data/outputs_part1/P5/12930,./data/outputs_part1/P5/12900,./data/outputs_part1/P5/12960,3#./data/outputs_part1/P8/25260,./data/outputs_part1/P8/25230,./data/outputs_part1/P8/25290,2#./data/outputs_part2/P3/12780,./data/outputs_part2/P3/12750,./data/outputs_part2/P3/12810,5#./data/outputs_part2/P10/20280,./data/outputs_part2/P10/20250,./data/outputs_part2/P10/20310,5#./data/outputs_part1/P8/13770,./data/outputs_part1/P8/13740,./data/outputs_part1/P8/13800,5#./data/outputs_part1/P9/13800,./data/outputs_part1/P9/13770,./data/outputs_part1/P9/13830,3#"
block3="./data/outputs_part4/1/5790,./data/outputs_part4/1/5760,./data/outputs_part4/1/5820,2#./data/outputs_part4/1/5820,./data/outputs_part4/1/5790,./data/outputs_part4/1/5850,2#./data/outputs_part4/1/5850,./data/outputs_part4/1/5820,./data/outputs_part4/1/5880,2#./data/outputs_part4/1/15810,./data/outputs_part4/1/15780,./data/outputs_part4/1/15840,0#./data/outputs_part4/1/15840,./data/outputs_part4/1/15810,./data/outputs_part4/1/15870,0#./data/outputs_part4/1/15870,./data/outputs_part4/1/15840,./data/outputs_part4/1/15900,1#./data/outputs_part4/1/16470,./data/outputs_part4/1/16440,./data/outputs_part4/1/16500,2#./data/outputs_part4/1/16500,./data/outputs_part4/1/16470,./data/outputs_part4/1/16530,2#./data/outputs_part4/1/16530,./data/outputs_part4/1/16500,./data/outputs_part4/1/16560,2#./data/outputs_part4/1/17460,./data/outputs_part4/1/17430,./data/outputs_part4/1/17490,3#./data/outputs_part4/1/17490,./data/outputs_part4/1/17460,./data/outputs_part4/1/17520,3#./data/outputs_part4/1/17520,./data/outputs_part4/1/17490,./data/outputs_part4/1/17550,3#./data/outputs_part4/1/17640,./data/outputs_part4/1/17610,./data/outputs_part4/1/17670,3#./data/outputs_part4/1/17670,./data/outputs_part4/1/17640,./data/outputs_part4/1/17700,3#./data/outputs_part4/1/17700,./data/outputs_part4/1/17670,./data/outputs_part4/1/17730,3#./data/outputs_part4/1/18090,./data/outputs_part4/1/18060,./data/outputs_part4/1/18120,3#./data/outputs_part4/1/18120,./data/outputs_part4/1/18090,./data/outputs_part4/1/18150,3#./data/outputs_part4/1/18150,./data/outputs_part4/1/18120,./data/outputs_part4/1/18180,3#./data/outputs_part4/1/19260,./data/outputs_part4/1/19230,./data/outputs_part4/1/19290,2#./data/outputs_part4/1/19290,./data/outputs_part4/1/19260,./data/outputs_part4/1/19320,2#./data/outputs_part4/1/19320,./data/outputs_part4/1/19290,./data/outputs_part4/1/19350,2#./data/outputs_part4/1/20640,./data/outputs_part4/1/20610,./data/outputs_part4/1/20670,5#./data/outputs_part4/1/20670,./data/outputs_part4/1/20640,./data/outputs_part4/1/20700,5#./data/outputs_part4/1/20700,./data/outputs_part4/1/20670,./data/outputs_part4/1/20730,5#./data/outputs_part4/1/22530,./data/outputs_part4/1/22500,./data/outputs_part4/1/22560,2#./data/outputs_part4/1/22560,./data/outputs_part4/1/22530,./data/outputs_part4/1/22590,2#./data/outputs_part4/1/22590,./data/outputs_part4/1/22560,./data/outputs_part4/1/22620,2#./data/outputs_part4/1/25170,./data/outputs_part4/1/25140,./data/outputs_part4/1/25200,1#./data/outputs_part4/1/25200,./data/outputs_part4/1/25170,./data/outputs_part4/1/25230,1#./data/outputs_part4/1/25230,./data/outputs_part4/1/25200,./data/outputs_part4/1/25260,1#"
block4="./data/outputs_part4/2/19830,./data/outputs_part4/2/19800,./data/outputs_part4/2/19860,5#./data/outputs_part4/2/20910,./data/outputs_part4/2/20880,./data/outputs_part4/2/20940,5#./data/outputs_part4/2/22080,./data/outputs_part4/2/22050,./data/outputs_part4/2/22110,5#./data/outputs_part4/2/26430,./data/outputs_part4/2/26400,./data/outputs_part4/2/26460,2#./data/outputs_part4/3/4650,./data/outputs_part4/3/4620,./data/outputs_part4/3/4680,3#./data/outputs_part4/3/9780,./data/outputs_part4/3/9750,./data/outputs_part4/3/9810,3#./data/outputs_part4/3/10410,./data/outputs_part4/3/10380,./data/outputs_part4/3/10440,3#./data/outputs_part4/3/14940,./data/outputs_part4/3/14910,./data/outputs_part4/3/14970,2#./data/outputs_part4/3/24390,./data/outputs_part4/3/24360,./data/outputs_part4/3/24420,0#./data/outputs_part4/4/3540,./data/outputs_part4/4/3510,./data/outputs_part4/4/3570,3#./data/outputs_part4/4/3720,./data/outputs_part4/4/3690,./data/outputs_part4/4/3750,3#./data/outputs_part4/4/4080,./data/outputs_part4/4/4050,./data/outputs_part4/4/4110,3#./data/outputs_part4/4/4410,./data/outputs_part4/4/4380,./data/outputs_part4/4/4440,2#./data/outputs_part4/4/5040,./data/outputs_part4/4/5010,./data/outputs_part4/4/5070,3#./data/outputs_part4/4/12030,./data/outputs_part4/4/12000,./data/outputs_part4/4/12060,2#./data/outputs_part4/4/15930,./data/outputs_part4/4/15900,./data/outputs_part4/4/15960,5#./data/outputs_part4/4/17070,./data/outputs_part4/4/17040,./data/outputs_part4/4/17100,1#./data/outputs_part4/4/18090,./data/outputs_part4/4/18060,./data/outputs_part4/4/18120,1#./data/outputs_part4/4/18180,./data/outputs_part4/4/18150,./data/outputs_part4/4/18210,2#./data/outputs_part4/4/20670,./data/outputs_part4/4/20640,./data/outputs_part4/4/20700,5#./data/outputs_part4/4/20730,./data/outputs_part4/4/20700,./data/outputs_part4/4/20760,5#./data/outputs_part4/4/22380,./data/outputs_part4/4/22350,./data/outputs_part4/4/22410,0#./data/outputs_part4/4/23370,./data/outputs_part4/4/23340,./data/outputs_part4/4/23400,0#./data/outputs_part4/5/90,./data/outputs_part4/5/60,./data/outputs_part4/5/120,0#./data/outputs_part4/5/660,./data/outputs_part4/5/630,./data/outputs_part4/5/690,0#./data/outputs_part4/5/780,./data/outputs_part4/5/750,./data/outputs_part4/5/810,0#./data/outputs_part4/5/2460,./data/outputs_part4/5/2430,./data/outputs_part4/5/2490,0#./data/outputs_part4/5/5040,./data/outputs_part4/5/5010,./data/outputs_part4/5/5070,2#./data/outputs_part4/5/5160,./data/outputs_part4/5/5130,./data/outputs_part4/5/5190,1#./data/outputs_part4/5/5340,./data/outputs_part4/5/5310,./data/outputs_part4/5/5370,0#"
block5="./data/outputs_part4/5/6270,./data/outputs_part4/5/6240,./data/outputs_part4/5/6300,0#./data/outputs_part4/5/7980,./data/outputs_part4/5/7950,./data/outputs_part4/5/8010,3#./data/outputs_part4/5/16500,./data/outputs_part4/5/16470,./data/outputs_part4/5/16530,0#./data/outputs_part4/5/18060,./data/outputs_part4/5/18030,./data/outputs_part4/5/18090,2#./data/outputs_part4/5/25950,./data/outputs_part4/5/25920,./data/outputs_part4/5/25980,2#./data/outputs_part4/5/27630,./data/outputs_part4/5/27600,./data/outputs_part4/5/27660,2#./data/outputs_part4/5/27810,./data/outputs_part4/5/27780,./data/outputs_part4/5/27840,2#./data/outputs_part4/6/3240,./data/outputs_part4/6/3210,./data/outputs_part4/6/3270,3#./data/outputs_part4/6/10230,./data/outputs_part4/6/10200,./data/outputs_part4/6/10260,2#./data/outputs_part4/6/16050,./data/outputs_part4/6/16020,./data/outputs_part4/6/16080,3#./data/outputs_part4/6/17910,./data/outputs_part4/6/17880,./data/outputs_part4/6/17940,1#./data/outputs_part4/6/20610,./data/outputs_part4/6/20580,./data/outputs_part4/6/20640,5#./data/outputs_part4/6/20640,./data/outputs_part4/6/20610,./data/outputs_part4/6/20670,5#./data/outputs_part4/6/24930,./data/outputs_part4/6/24900,./data/outputs_part4/6/24960,0#./data/outputs_part4/7/2190,./data/outputs_part4/7/2160,./data/outputs_part4/7/2220,1#./data/outputs_part4/7/2970,./data/outputs_part4/7/2940,./data/outputs_part4/7/3000,0#./data/outputs_part4/7/6330,./data/outputs_part4/7/6300,./data/outputs_part4/7/6360,3#./data/outputs_part4/7/7020,./data/outputs_part4/7/6990,./data/outputs_part4/7/7050,0#./data/outputs_part4/7/8100,./data/outputs_part4/7/8070,./data/outputs_part4/7/8130,2#./data/outputs_part4/7/13530,./data/outputs_part4/7/13500,./data/outputs_part4/7/13560,2#./data/outputs_part4/7/13710,./data/outputs_part4/7/13680,./data/outputs_part4/7/13740,3#./data/outputs_part4/7/13830,./data/outputs_part4/7/13800,./data/outputs_part4/7/13860,3#./data/outputs_part4/7/13890,./data/outputs_part4/7/13860,./data/outputs_part4/7/13920,3#./data/outputs_part4/7/14310,./data/outputs_part4/7/14280,./data/outputs_part4/7/14340,3#./data/outputs_part4/7/14730,./data/outputs_part4/7/14700,./data/outputs_part4/7/14760,2#./data/outputs_part4/7/15900,./data/outputs_part4/7/15870,./data/outputs_part4/7/15930,2#./data/outputs_part4/7/20070,./data/outputs_part4/7/20040,./data/outputs_part4/7/20100,3#./data/outputs_part4/7/22260,./data/outputs_part4/7/22230,./data/outputs_part4/7/22290,3#./data/outputs_part4/7/22470,./data/outputs_part4/7/22440,./data/outputs_part4/7/22500,3#./data/outputs_part4/7/23640,./data/outputs_part4/7/23610,./data/outputs_part4/7/23670,0#"
block6="./data/outputs_part4/8/330,./data/outputs_part4/8/300,./data/outputs_part4/8/360,0#./data/outputs_part4/8/1440,./data/outputs_part4/8/1410,./data/outputs_part4/8/1470,1#./data/outputs_part4/8/3270,./data/outputs_part4/8/3240,./data/outputs_part4/8/3300,0#./data/outputs_part4/8/7230,./data/outputs_part4/8/7200,./data/outputs_part4/8/7260,0#./data/outputs_part4/8/7590,./data/outputs_part4/8/7560,./data/outputs_part4/8/7620,0#./data/outputs_part4/8/9330,./data/outputs_part4/8/9300,./data/outputs_part4/8/9360,0#./data/outputs_part4/8/9600,./data/outputs_part4/8/9570,./data/outputs_part4/8/9630,0#./data/outputs_part4/8/14040,./data/outputs_part4/8/14010,./data/outputs_part4/8/14070,5#./data/outputs_part4/8/17730,./data/outputs_part4/8/17700,./data/outputs_part4/8/17760,2#./data/outputs_part4/8/19560,./data/outputs_part4/8/19530,./data/outputs_part4/8/19590,1#./data/outputs_part4/8/23580,./data/outputs_part4/8/23550,./data/outputs_part4/8/23610,2#./data/outputs_part4/8/23610,./data/outputs_part4/8/23580,./data/outputs_part4/8/23640,2#./data/outputs_part4/8/27060,./data/outputs_part4/8/27030,./data/outputs_part4/8/27090,2#./data/outputs_part4/9/990,./data/outputs_part4/9/960,./data/outputs_part4/9/1020,1#./data/outputs_part4/9/1440,./data/outputs_part4/9/1410,./data/outputs_part4/9/1470,1#./data/outputs_part4/9/1860,./data/outputs_part4/9/1830,./data/outputs_part4/9/1890,2#./data/outputs_part4/9/5910,./data/outputs_part4/9/5880,./data/outputs_part4/9/5940,3#./data/outputs_part4/9/8820,./data/outputs_part4/9/8790,./data/outputs_part4/9/8850,2#./data/outputs_part4/9/10410,./data/outputs_part4/9/10380,./data/outputs_part4/9/10440,3#./data/outputs_part4/9/15480,./data/outputs_part4/9/15450,./data/outputs_part4/9/15510,5#./data/outputs_part4/9/16200,./data/outputs_part4/9/16170,./data/outputs_part4/9/16230,1#./data/outputs_part4/9/17160,./data/outputs_part4/9/17130,./data/outputs_part4/9/17190,2#./data/outputs_part4/9/18000,./data/outputs_part4/9/17970,./data/outputs_part4/9/18030,2#./data/outputs_part4/9/18330,./data/outputs_part4/9/18300,./data/outputs_part4/9/18360,3#./data/outputs_part4/9/21210,./data/outputs_part4/9/21180,./data/outputs_part4/9/21240,1#./data/outputs_part4/9/22860,./data/outputs_part4/9/22830,./data/outputs_part4/9/22890,5#./data/outputs_part4/9/26640,./data/outputs_part4/9/26610,./data/outputs_part4/9/26670,2#./data/outputs_part4/9/26670,./data/outputs_part4/9/26640,./data/outputs_part4/9/26700,2#./data/outputs_part4/9/27870,./data/outputs_part4/9/27840,./data/outputs_part4/9/27900,2#./data/outputs_part4/10/240,./data/outputs_part4/10/210,./data/outputs_part4/10/270,0#"
block7="./data/outputs_part4/10/450,./data/outputs_part4/10/420,./data/outputs_part4/10/480,0#./data/outputs_part4/10/3120,./data/outputs_part4/10/3090,./data/outputs_part4/10/3150,1#./data/outputs_part4/10/3990,./data/outputs_part4/10/3960,./data/outputs_part4/10/4020,2#./data/outputs_part4/10/7680,./data/outputs_part4/10/7650,./data/outputs_part4/10/7710,5#./data/outputs_part4/10/7830,./data/outputs_part4/10/7800,./data/outputs_part4/10/7860,5#./data/outputs_part4/10/8100,./data/outputs_part4/10/8070,./data/outputs_part4/10/8130,2#./data/outputs_part4/10/8580,./data/outputs_part4/10/8550,./data/outputs_part4/10/8610,3#./data/outputs_part4/10/8640,./data/outputs_part4/10/8610,./data/outputs_part4/10/8670,3#./data/outputs_part4/10/8880,./data/outputs_part4/10/8850,./data/outputs_part4/10/8910,3#./data/outputs_part4/10/11610,./data/outputs_part4/10/11580,./data/outputs_part4/10/11640,0#./data/outputs_part4/10/13350,./data/outputs_part4/10/13320,./data/outputs_part4/10/13380,2#./data/outputs_part4/10/13470,./data/outputs_part4/10/13440,./data/outputs_part4/10/13500,1#./data/outputs_part4/10/15720,./data/outputs_part4/10/15690,./data/outputs_part4/10/15750,1#./data/outputs_part4/10/17850,./data/outputs_part4/10/17820,./data/outputs_part4/10/17880,1#./data/outputs_part4/10/18090,./data/outputs_part4/10/18060,./data/outputs_part4/10/18120,2#./data/outputs_part4/10/21240,./data/outputs_part4/10/21210,./data/outputs_part4/10/21270,5#./data/outputs_part4/10/21300,./data/outputs_part4/10/21270,./data/outputs_part4/10/21330,5#./data/outputs_part4/10/21450,./data/outputs_part4/10/21420,./data/outputs_part4/10/21480,2#./data/outputs_part4/10/23430,./data/outputs_part4/10/23400,./data/outputs_part4/10/23460,0#./data/outputs_part4/10/23520,./data/outputs_part4/10/23490,./data/outputs_part4/10/23550,0#"

criterionSplit=[];

criterionSounds=[];
criterionSounds_pre=[];
criterionSounds_pre=[];
criterionSounds_post=[];
criterionImages=[];
criterionImages_pre=[];
criterionImages_post=[];
currentImage=1;
epoch=1;
change=true;
font=null;
userStage="";

practiceStage=0;

totalClicks=0;
results="";

playSound=true; //should the sound play
dropout=true; //should we keep looping through items until they're gotten correct (true) or go through each only once (false)
pid=0;
startTime=Date.now();
block='0';
demo='';
rts=[];
rtcrit=true; //does the rt distribution look reasonable?
function median(numbers) {
    const sorted = Array.from(numbers).sort((a, b) => a - b);
    const middle = Math.floor(sorted.length / 2);

    if (sorted.length % 2 === 0) {
        return (sorted[middle - 1] + sorted[middle]) / 2;
    }

    return sorted[middle];
}

function preload() {
  demo=loadImage("./data/demo.png");
  urlParams = new URLSearchParams(window.location.search);
  block = urlParams.get('block');
  pid = urlParams.get('pid');
  soundBlock=urlParams.get('sound');
  if (soundBlock=="true") { //play sounds if we are in the sound block
    playSound=true;
  }
  else {
    playSound=false;
  }
  //font=loadFont("../data/font.vlw");
  //load the correct stimuli. If it's 0 or not specified, load the criterion test
  if (block=='1') {
    criterion=block1;
    dropout=false;
    console.log("Loading block1");
  }
  if (block=='2') {
    criterion=block2;
    dropout=false;
    console.log("Loading block2");
  }
 if (block=='3') {
    criterion=block3;
    dropout=false;
    console.log("Loading block3");
  }
    if (block=='4') {
    criterion=block4;
    dropout=false;
    console.log("Loading block4");
  }
  
    if (block=='5') {
    criterion=block5;
    dropout=false;
    console.log("Loading block5");
  }
    if (block=='6') {
    criterion=block6;
    dropout=false;
    console.log("Loading block6");
  }
    if (block=='7') {
    criterion=block2;
    dropout=false;
    console.log("Loading block7");
	playSound=false; //sound is always off in block7
  }
  criterionSplit=criterion.split("#");

criterionSplit.forEach((val) => {
    if (val.length > 1) {
      try {
      console.log(val);
      splitup=val.split(",");
      try{
      img1=loadImage(splitup[0]+".png");
      sound = loadSound(splitup[0]+".wav");
      criterionSounds.push(sound);
      criterionImages.push(img1);
      } catch (exceptionVar) {
        console.log("Error on image: "+splitup[0]+exceptionVar);
    }
     try {
      img2=loadImage(splitup[1]+".png");
      sound = loadSound(splitup[1]+".wav");
      criterionSounds_pre.push(sound);
      criterionImages_pre.push(img2);
      }
      catch (exceptionVar) {
        console.log("Error on image: "+splitup[1]+exceptionVar);
      }
      try {
      img3=loadImage(splitup[2]+".png");
      sound = loadSound(splitup[2]+".wav");
      criterionSounds_post.push(sound);
      criterionImages_post.push(img3);
      }
      catch (exceptionVar) {
        console.log("Error on image: "+splitup[2]);
      }
      }
      catch (exceptionvar) {
        
      }
      
}


});
console.log("Size of pre images is "+criterionImages_pre.length);
console.log("Size of post images is "+criterionImages_post.length);
}

function setup() {
  createCanvas(1200, 600);
  textFont("Helvetica");
  textSize(20);
      /*
      img=loadImage((parseInt(splitup[0])-30)+".png");
      criterionImages_pre.push(img);
*/
      
      
    }
    
function dropoutCorrect(stage) {
  console.log("User stage:"+stage+", correct="+criterionSplit[currentImage].split(",")[3]+",dropout="+dropout);
  correct=criterionSplit[currentImage].split(",")[3];
  if (correct.indexOf(stage) > -1 || !dropout) { //if it was correct OR this is a non-dropout block, remove this item from all the arrays
    criterionSounds.splice(currentImage,1);
    criterionSounds_pre.splice(currentImage,1);
    criterionSounds_post.splice(currentImage,1);
    criterionImages.splice(currentImage,1);
    criterionImages_pre.splice(currentImage,1);
    criterionImages_post.splice(currentImage,1);
    criterionSplit.splice(currentImage,1);
  }
  
}
    
function keyPressed() {
	  if (practiceStage == -2) {
    practiceStage++;
  }
  else if (practiceStage == -1) {
    practiceStage=1;
  }
  
  if (practiceStage == 1) {
  if (keyCode == RIGHT_ARROW) {
    epoch++;
    totalClicks++;
  }
  if (keyCode == LEFT_ARROW) {
    epoch--;
    totalClicks++;
  }
  if (epoch < 0) {
    epoch=0;
    totalClicks--;
  }
  if (epoch > 2) {
    epoch=2;
    totalClicks--;
  }
  change=true;
  if (epoch == 1) { //we are viewing the epoch
    if (key == '0' || key == '1' || key == '2' || key == '3' || key == 'r' || key == 'R' || key == 'w' || key == 'W' || key == '5') {
      if (key == 'r' || key == 'R') {
          userStage='5';
      }
      if (key == 'w' || key == 'W') {
          userStage='0';
      }
      else {
      userStage=key;
      }
      userStage=userStage.replace("r","5").replace("R","5");
      practiceStage=2;
      if (playSound) {
      criterionSounds[currentImage].play();
      }
      timeSpent=round((Date.now()-startTime)/1000,2);
      correct=criterionSplit[currentImage].split(",")[3];
	  fileName=criterionSplit[currentImage].split(",")[0];
      isCorrect=calculateCorrect(userStage, correct);
	    //@sam this runs once per trial and updates the results for each trial. UserStage is the stage the person said, correct is the correct stange, timeSpent is the number of seconds spent on the trial and totalClicks is the number of backwards or forwards command shtye gave.
      results=results+","+fileName+":"+userStage+":"+correct+":"+timeSpent+":"+totalClicks;
	  rts.push(timeSpent); //log the rt for this trial
      sendDataToSheet(userStage, correct, timeSpent, totalClicks, pid, block, playSound, isCorrect);
      totalClicks=0; 
      
    }  
  }
  }

  else if (practiceStage == 2) {
    
    if (key == ' ') {
      dropoutCorrect(userStage);
      if (criterionSounds.length > 0) {
        currentImage=Math.floor(Math.random() * criterionSounds.length);
        practiceStage = 1;
        epoch=1;
        startTime=Date.now();
      }
      else {
        practiceStage=3;
        console.log("No more items!");
      }
    
    }
  }
}

function calculateCorrect(a, b) {
  if (a === b) {
      return 1;
  } else {
      return 0;
  }
}

function sendDataToSheet(userStage, correct, timeSpent, totalClicks, pid, block, playSound, isCorrect){
  // code that puts everything in a google doc
  let res_key = ["userStage", "correctStage", "timeSpent", "totalClicks", "UserID", "block", "sound", "isCorrect"];
  let res_val = [userStage, correct, timeSpent, int(totalClicks), pid, block, int(playSound), isCorrect];
  var script_result = {};

  res_key.forEach(function (k, i) {
      script_result[k] = res_val[i];
  })

  console.log(JSON.stringify(script_result));

  const url = "https://script.google.com/macros/s/AKfycbxRFheUC48A_7MwukU3h8lQJs8AVM4ydHyOfsd1-AwASNZ1IPa2GRC5Fi10wu5NpSkh/exec";

  fetch(url,{
    method: 'POST', // *GET, POST, PUT, DELETE, etc.
    mode: 'no-cors', // no-cors, *cors, same-origin
    cache: 'no-cache', // *default, no-cache, reload, force-cache, only-if-cached
    headers: {
      'Content-Type': 'application/json'
    },
    redirect: 'follow', // manual, *follow, error
    body: JSON.stringify(script_result)})
  }

function mouseClicked() {
 if (practiceStage == 0) {
    if (block.indexOf('0') == -1) { //move from the intro to the task if we are in the regular block, but display an additional training screen if we are in the first block.
    practiceStage=1;
    startTime=Date.now();
    }
    else {
      practiceStage = -2;
    }
  }
  
}
function draw() {
  stroke(255);
  fill(255);

  let x_margin = 40; 
  
    if (practiceStage == -2) {
      background(0);
       image(demo,x_margin,0,1100,500,0,0,criterionImages_pre[0].width,1420);
	   if (playSound) {
        text("This is how sleep will be displayed. In this practice, you will also hear the EEG transformed into a sound. \nMake sure your volume is turned up. \nPress any key to continue.",x_margin, 520);
	   }
	   else {
		text("This is how sleep will be displayed.  \nPress any key to continue.",x_margin, 520);

	   }
    }
   else if (practiceStage == -1) {
     background(0);
       text("First we will have you practice scoring 20 epochs of sleep. \nEach epoch comes from a different subject.  You will see each epoch until you get it correct. \nYou should hear sounds associated with each epoch \nPress any key to continue.",x_margin, 520);
    }
  if (practiceStage == 0) {
    background(0);

    if (block == 0) {
    text("Welcome to the sleep staging experiment!\nClick anywhere to continue.",x_margin, 50);
    }
    else {
      instructions="Now we will have you stage some more sleep. There are 30 epochs in this block, and each comes from a different subject. \nThis time you will see each epoch only once, so try to get it correct on the first try. \n#SOUND \nClick anywhere to continue.";
      if (playSound) {
        instructions=instructions.replace("#SOUND", "In this block, we will play also play sounds that represent the EEG signal in O1-A2 (the same as during the practice)");
      }
      else {
        instructions=instructions.replace("#SOUND", "In this block, you will NOT hear sounds that go with the EEG.");
      }
      text(instructions,x_margin, 50);
      
  }
  }
	
  
  else if (practiceStage == 1) {

  imageMode(CENTER);
  if (epoch == 0) { ///showing the 30 seconds before the stage 
  background(0);
  if (criterionImages_pre[currentImage] != undefined && criterionSounds_pre[currentImage] != undefined) {

  image(criterionImages_pre[currentImage],600,240,1100,500,0,0,criterionImages_pre[currentImage].width,1420);
  if (change && playSound) {
    criterionSounds_pre[currentImage].play();
    change=false;
  }
  }
  text("This is one epoch before the epoch to stage. \nUse the right arrow to go forward in time.",x_margin, 520);
  }
  if (epoch == 1) { ///showing the stage 
  background(50);
  if (criterionImages[currentImage] != undefined && criterionSounds[currentImage] != undefined) {
  image(criterionImages[currentImage],600,240,1100,500,0,0,criterionImages[currentImage].width,1420);
  if (change && playSound) {
   criterionSounds[currentImage].play();
    change=false;
  }
  }
   text("This is the epoch to stage. \nUse arrow keys to move backwards or forwards in time. \nUse w, 1, 2, 3, and R keys to stage the epoch.",x_margin, 520);
  //  console.log(criterionImages_post[currentImage])
  }
  if (epoch == 2) { ///showing the 30 seconds before the stage 
  background(0);
  if (criterionImages_post[currentImage] != undefined && criterionSounds_post[currentImage] != undefined) {
  image(criterionImages_post[currentImage],600,240,1100,500,0,0,criterionImages_post[currentImage].width,1420);
  if (change && playSound) {
    criterionSounds_post[currentImage].play();
    change=false;
  }
  }
   text("This is one epoch after the epoch to stage.\nUse the left arrow to go back in time.",x_margin, 520);
  }
  }
  else if (practiceStage == 2) { //getting feedback on stage
  background(0);
  image(criterionImages[currentImage],600,240,1100,500,0,0,criterionImages[currentImage].width,1420);
   
   correct=criterionSplit[currentImage].split(",")[3];
   text("This epoch is stage "+(correct+"").replace("5","REM").replace("0","wake")+".",x_margin, 520);
  
   if (correct.indexOf(userStage) > -1) {
     fill(0,200,0);
     stroke(0,200,0);
   }
   else {
     fill(200,0,0);
     stroke(200,0,0);
   }
   text("You said: Stage "+userStage.replace("5","REM").replace("0","wake")+"\nPress space to continue.",x_margin, 550);
   
  }
  else if (practiceStage == 3) {
	  //compute whether valid responses based on rt
	 if (median(rts) < 2) {
		 rtcrit=false;
	 }
    window.location.replace("https://mit.co1.qualtrics.com/jfe/form/SV_0pwKV9gTyvvYRT0?data="+results+"&pid="+pid+"&sound="+soundBlock+"&block="+block+"&rts="+median(rts)+"&rtcrit="+rtcrit);
    frameRate(0.001);
  }
    
  
  
}
